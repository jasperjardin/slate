@use "helpers/init" as *;

figure.wp-block-table {
	@include body(true);
	border: 0;

	table {
		border-radius: $border-radius;
		border-collapse: separate;
		border-spacing: 0;

		td,
		th {
			@include body(false);
			min-width: r(135);
			padding: $spacing-2xs;
			border: 1px solid var(--general-line);

			&:not(:first-child) {
				border-left-width: 0;
			}
		}

		td {
			color: var(--text-body);
			background-color: var(--general-bg);
		}

		tbody {
			tr:first-child {
				td:first-child {
					border-top-left-radius: $border-radius;
				}

				td:last-child {
					border-top-right-radius: $border-radius;
				}
			}

			tr:last-child {
				td:first-child {
					border-bottom-left-radius: $border-radius;
				}

				td:last-child {
					border-bottom-right-radius: $border-radius;
				}
			}

			&:has(+ tfoot) {
				tr:last-child {
					td:first-child {
						border-bottom-left-radius: 0;
					}

					td:last-child {
						border-bottom-right-radius: 0;
					}
				}
			}

			tr:not(:last-child) {
				th,
				td {
					border-bottom-width: 0;
				}
			}
		}

		thead {
			border-bottom: 0;

			tr {
				th,
				td {
					color: $text-body-dark;
					font-weight: $font-weight-heading;
					border-color: rgba($general-line-dark, 0.1) !important; // Override generic td/th
					border-bottom-width: 0;
					background-color: $general-bg-dark;

					// TODO: need a more fool proof solution. This will fail on multi-nested instances.
					[data-theme="dark"] & {
						color: $text-body-white;
						border-color: rgba($general-line-white, 0.1) !important; // Override generic td/th
						background-color: $general-bg-white;
					}
				}
			}

			tr:first-child {
				th:first-child {
					border-top-left-radius: $border-radius;
				}

				th:last-child {
					border-top-right-radius: $border-radius;
				}
			}

			+ tbody {
				tr:first-child {
					td:first-child {
						border-top-left-radius: 0;
					}

					td:last-child {
						border-top-right-radius: 0;
					}
				}
			}
		}

		tfoot {
			border-top: 0;

			th,
			td {
				border-top-width: 0;
				background-color: var(--general-box-bg);
			}

			tr:last-child {
				td:first-child {
					border-bottom-left-radius: $border-radius;
				}

				td:last-child {
					border-bottom-right-radius: $border-radius;
				}
			}
		}
	}

	&.is-style-stripes {
		border-bottom: 0;

		table {
			td,
			th {
				border-color: var(--general-line);
			}

			thead {
				th,
				td {
					border-color: var(--general-line);
				}
			}

			tbody {
				tr:nth-child(even) {
					background-color: transparent;

					th,
					td {
						background-color: var(--general-box-bg);
					}
				}
			}
		}
	}

	.wp-element-caption {
		@include body-small(false);
		margin-top: $spacing-xs;
	}
}
